package me.gamrboy4life.paradox.module.c;
import me.gamrboy4life.paradox.module.Category;
import me.gamrboy4life.paradox.module.Module;
import net.minecraft.client.Minecraft;
import net.minecraft.init.Blocks;
import net.minecraft.network.play.client.C07PacketPlayerDigging;
import net.minecraft.util.BlockPos;
import net.minecraft.util.EnumFacing;

public class Run extends Module {

    private boolean hasPrintedHelloWorld = false;

    public Run() {
        super("Run", 0, Category.RUN);
    }

    @Override
    public void onUpdate() {
        // モジュールがトグルされており、処理がまだ実行されていない場合
        if (isToggled() && !hasPlacedBlock) {
            placeBlock(100, 64, 100);
            System.out.println("Heavy process completed");

            // 処理が完了した後、フラグをtrueに設定
            hasPlacedBlock = true;

            // モジュールのトグルを解除
            toggled = false;
        }
    }

    private void placeBlock(int x, int y, int z) {
        Minecraft mc = Minecraft.getMinecraft();
        if (mc.theWorld != null) {
            BlockPos blockPos = new BlockPos(x, y, z);
            
            // ブロックの設置をサーバーにリクエストする
            mc.thePlayer.sendQueue.addToSendQueue(new C08PacketPlayerBlockPlacement(blockPos, EnumFacing.UP.getIndex(), mc.thePlayer.getHeldItem(), 0.5f, 1.0f, 0.5f));
            
            // クライアント側でのブロック設置
            mc.theWorld.setBlockState(blockPos, Blocks.stone.getDefaultState());
        }
    }

    @Override
    public void onEnable() {
        super.onEnable();
        hasPrintedHelloWorld = false; // Reset the flag when the module is enabled
    }

    @Override
    public void onDisable() {
        super.onDisable();
        hasPrintedHelloWorld = false; // Reset the flag when the module is disabled
    }
}